```mermaid
sequenceDiagram
participant Client
participant CouponController
participant CouponService
participant CouponRepository
participant UserCoupon

    Client->> CouponController: 쿠폰 발급 요청 (userId, couponId)
    CouponController ->> CouponService: 발급 요청 전달
    CouponService ->> CouponRepository: 쿠폰 조회
alt 쿠폰이 존재하지 않을 때
CouponRepository -->> CouponService: 쿠폰 존재 X 반환
CouponService -->> CouponController: 쿠폰 존재 X 예외 발생
CouponController --> Client: 404 Not Found
else 쿠폰 수량이 부족할 때
CouponRepository -->> CouponService: 쿠폰 수량 X 반환
CouponService -->> CouponController: 쿠폰 수량 X 예외 발생
CouponController -->> Client: 쿠폰 수량 X 응답 코드
else 쿠폰이 존재할 때
CouponRepository -->> CouponService: 쿠폰 정보 반환
else 사용자가 쿠폰을 보유하고 있을 때
CouponService -->> UserCoupon: 사용자 쿠폰 보유 조회
UserCoupon -->> CouponService: 쿠폰 보유 정보 반환
CouponService -->> CouponController: 쿠폰 보유 예외 발생
CouponController -->> Client: 쿠폰 보유 응답 코드
else 쿠폰 발급 가능 상태일 때
CouponService ->> UserCoupon: 쿠폰 정보 저장
UserCoupon -->> CouponService: 저장 정보 반환
CouponService ->> CouponRepository: 쿠폰 상태 업데이트
CouponRepository -->> CouponService: 저장 정보 반환
CouponService -->> CouponController: 저장 정보 응답
CouponController -->> Client: 정보 응답 코드
end
    
