# **E-commerce 요구사항**

---

---

## 🔶기능적 요구사항

---

### 1️⃣ **잔액충전 / 조회**

- 사용자는 잔액을 충전할 수 있습니다.
    - 입력 값 : 사용자 ID & 충전 금액
    - 사용자 ID가 0 이하 아닌지 검증
    - 입력 값 사용자 ID로 사용자가 존재하는 지 검증
    - 충전 금액이 0 이하 아닌지 검증
    - 충전 금액은 최소 100,000원
    - 사용자 최대 보유 금액은 3,000,000원
    - 충전 성공 후 이력에 남긴다.
- 사용자는 보유 잔액을 조회할 수 있습니다.
    - 입력 값 : 사용자 ID
    - 사용자 ID가 0 이하 아닌지 검증
    - 입력 값 사용자 ID로 사용자가 존재하는 지 검증

### 2️⃣ **상품 조회 API**

- 사용자는 상품을 조회할 수 있습니다.
    - 상품명, 가격, 잔여 수량 확인
    - 조회 시점의 상품별 잔여 수량이 정확해야 한다.

### 3️⃣  **선착순 쿠폰 발급**

- 사용자가 선착순 쿠폰을 발급 요청 합니다.
    - 입력 값 : 사용자 ID & 쿠폰 ID
    - 쿠폰이 존재 하는지, 수량이 남아 있는지, 사용자가 이미 쿠폰을 보유하고 있는지 검증
    - 발급된 쿠폰의 할인율에 따라, 주문 금액에 대해 할인 혜택을 받을 수 있다.
- 사용자는 보유하고 있는 쿠폰을 조회할 수 있습니다.
    - 입력 값 : 사용자 ID
    - 사용자 ID 검증 후 조회 성공/실패 반환

### 4️⃣ 주문 / 결제

- 사용자가 주문을 요청합니다
    - 입력 값 : 사용자 ID & 쿠폰 ID & 상품 ID & 구매 수량
    - 구매할 상품의 재고 수량 조회 후 성공/실패 반환
    - 사용할 쿠폰이 존재하는 지, 유효 기간 또는 사용 가능 상태인지 조회 후 성공(쿠폰 상태 변경)/실패 반환
    - 쿠폰 할인율 적용 후 총 금액 반환
    - 주문 상품 생성
- 주문에 대한 결제를 요청합니다.
    - 입력 값 : 사용자 ID
    - 사용자 ID로 잔고 조회 후 결제 금액보다 적으면 실패 반환
    - 잔고가 충분하다면 잔고 차감 및 이력 업데이트
    - 쿠폰의 상태를 사용 완료로 업데이트
    - 상품의 재고 수량 업데이트
    - 주문 완료(결제 완료)

### 5️⃣  **상위 상품 조회 API**

- 사용자가 최근 3일간 가장 많이 팔린 상위 5개 상품 정보를 조회할 수 있습니다.
    - 상품의 주문 수량을 기준으로 가장 큰 수 부터 노출한다.

---

## 🔶비기능적 요구사항

- 포인트 충전/차감 동시성 제어
- 쿠폰의 요청이 동시에 들어와도 중복 발급 없이 정확한 수량 차감
- 주문 및 결제는 하나의 트랜잭션에서 처리 및 상품 재고 동시성 제어
